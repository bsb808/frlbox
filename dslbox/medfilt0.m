function [Y,II] = medfilt0(X,m,dx)% median filter algorithm taken from dyoerger%% x - original data vector% m - length of the median filter (maybe 5)% dx - tolerance for the filter%% returns a new set of data of the same length as the original% by setting bad points to zero%%% 03.07.04 bbing% 05.11.04  bsb  making it handle matricies (each column is a vector)% allocateY = zeros(size(X));% loop for each columnfor ii = 1:size(X,2)    x = X(:,ii);    n = length(x);    y = zeros(size(x));	cnt = 1;    for i = 1+m: n-m-1,        ind = [[i-m:i-1]';[i+1:i+m]'];        xm = median(x(ind));        if( (abs(x(i)-xm)) < dx)            y(i)=x(i);			II(cnt) = i;			cnt = cnt+1;        end    end        Y(:,ii) = y;    end