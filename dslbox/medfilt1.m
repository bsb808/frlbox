function [Y,II] = medfilt1(X,m,dx)% median filter algorithm taken from dyoerger%% x - original data vector% m - length of the median filter (maybe 5)% dx - tolerance for the filter%% returns a new set of data of the same length as the original% by setting bad points to zero%%% 03.07.04 bbing% 05.11.04  bsb  making it handle matricies (each column is a vector)% 08.02.27  bsb  allowing for returning a truncated matrix% for just the first columnx = X(:,1);n = length(x);Y = [];cnt = 1;for i = 1+m: n-m-1,	ind = [[i-m:i-1]';[i+1:i+m]'];	xm = median(x(ind));	if( (abs(x(i)-xm)) < dx)		Y(cnt,:)=X(cnt,:);		II(cnt) = i;		cnt = cnt + 1;	endend